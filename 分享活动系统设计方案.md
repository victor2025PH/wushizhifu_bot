# 分享活动系统设计方案

## 🎯 活动目标
提升用户活跃度和推广力度，通过奖励机制激励用户分享和邀请好友。

## 📋 活动规则设计

### 一级推荐奖励
- **分享奖励**：成功邀请好友注册并使用机器人，可获得 **10 USDT** 奖励
- **好友奖励**：被邀请的好友首次交易成功，分享者可获得交易金额的 **1%** 作为分红（最高 100 USDT/笔）
- **好友福利**：被邀请的好友首次交易可获得 **5 USDT** 红包

### 抽奖活动
- **参与条件**：每成功邀请 **5 位好友**（好友需完成首次交易），即可获得 1 次抽奖机会
- **抽奖奖励**：
  - 🏆 一等奖：**500 USDT**（10% 概率）
  - 🥈 二等奖：**100 USDT**（20% 概率）
  - 🥉 三等奖：**50 USDT**（30% 概率）
  - 🎁 幸运奖：**10 USDT**（40% 概率）
- **次数限制**：每月最多可获得 10 次抽奖机会

### 月度排行榜
- **统计周期**：每月 1 日 00:00 至月底 23:59
- **排名规则**：按成功邀请好友数量（需完成首次交易）排名
- **奖励分配**：
  - 🥇 第 1 名：**999 USDT** + 专属 VIP3 等级
  - 🥈 第 2 名：**888 USDT** + 专属 VIP2 等级
  - 🥉 第 3 名：**777 USDT** + 专属 VIP1 等级
  - 🎖️ 第 4-10 名：**100 USDT**
- **发放时间**：次月 5 日前发放奖励

### 邀请好友条件
- ✅ 好友通过分享链接注册
- ✅ 好友完成首次交易（任意金额）
- ✅ 交易状态为"已支付"（paid）

## 🗄️ 数据库设计

### referrals 表（推荐关系）
```
- referral_id: 主键
- referrer_id: 推荐人用户ID
- referred_id: 被推荐人用户ID
- referral_code: 推荐码（推荐人的）
- status: 状态（pending, registered, first_transaction, rewarded）
- first_transaction_at: 首次交易时间
- reward_amount: 奖励金额
- created_at: 创建时间
- updated_at: 更新时间
```

### referral_codes 表（推荐码）
```
- user_id: 用户ID（主键）
- referral_code: 推荐码（唯一）
- total_invites: 总邀请数
- successful_invites: 成功邀请数（完成首次交易）
- total_rewards: 累计奖励
- created_at: 创建时间
- updated_at: 更新时间
```

### referral_rewards 表（奖励记录）
```
- reward_id: 主键
- user_id: 用户ID
- reward_type: 奖励类型（invite, dividend, lottery, ranking）
- amount: 奖励金额
- referral_id: 关联的推荐关系ID（可选）
- description: 奖励说明
- status: 状态（pending, paid）
- paid_at: 发放时间
- created_at: 创建时间
```

### lottery_entries 表（抽奖记录）
```
- entry_id: 主键
- user_id: 用户ID
- prize_level: 奖品等级（1, 2, 3, 4）
- prize_amount: 奖品金额
- status: 状态（pending, claimed）
- claimed_at: 领取时间
- created_at: 创建时间
```

### monthly_rankings 表（月度排行榜）
```
- ranking_id: 主键
- user_id: 用户ID
- month: 月份（YYYY-MM）
- invite_count: 邀请数量
- rank: 排名
- reward_amount: 奖励金额
- status: 状态（pending, paid）
- paid_at: 发放时间
- created_at: 创建时间
```

## 🎨 UI/UX 设计

### 主界面布局
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  🎁 分享有礼 活动中心
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💎 我的分享数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 总邀请：15 人
✅ 成功邀请：12 人
💰 累计奖励：156.50 USDT
🎲 抽奖次数：2 次
🏆 本月排名：第 8 名

🎯 活动规则
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📱 邀请好友：10 USDT/人
💸 交易分红：交易额 1%（最高 100 USDT）
🎁 好友红包：首次交易送 5 USDT
🎲 每 5 人可抽奖
🏆 月度前三：999/888/777 USDT

[邀请好友] [我的奖励] [排行榜] [抽奖]
```

### 邀请页面
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  📱 邀请好友赚奖励
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🆔 我的推荐码
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
复制推荐码：`WSP5433982810`

🔗 分享链接
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
https://t.me/wushi68_bot?start=ref_WSP5433982810

点击下方按钮快速分享给好友

[📤 分享给好友] [📋 复制链接] [📱 复制推荐码]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 邀请奖励说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 好友注册：+10 USDT
✅ 好友首次交易：+交易额 1%（最高 100 USDT）
✅ 好友获得：首次交易 5 USDT 红包
✅ 邀请 5 人：获得 1 次抽奖机会

[返回]
```

### 奖励记录页面
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  💰 我的奖励记录
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💎 奖励统计
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💰 累计奖励：156.50 USDT
💳 待发放：25.00 USDT
✅ 已发放：131.50 USDT

📋 最近奖励
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ +10.00 USDT - 邀请奖励
   2025-12-26 10:15

✅ +50.00 USDT - 抽奖（二等奖）
   2025-12-25 14:30

✅ +5.50 USDT - 交易分红
   2025-12-24 09:20

[查看更多] [返回]
```

### 排行榜页面
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  🏆 月度邀请排行榜
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📅 2025年12月

🥇 第 1 名：@user1
   邀请：156 人 | 奖励：999 USDT

🥈 第 2 名：@user2
   邀请：142 人 | 奖励：888 USDT

🥉 第 3 名：@user3
   邀请：128 人 | 奖励：777 USDT

4️⃣ 第 4 名：@user4 - 邀请：115 人
5️⃣ 第 5 名：@user5 - 邀请：98 人
...

🏆 您的排名：第 8 名
   邀请：67 人

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⏰ 距离结算：还有 5 天
   次月 5 日前发放奖励

[返回]
```

### 抽奖页面
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  🎲 幸运抽奖
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎁 奖品池
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🏆 一等奖：500 USDT（10%）
🥈 二等奖：100 USDT（20%）
🥉 三等奖：50 USDT（30%）
🎁 幸运奖：10 USDT（40%）

🎯 我的抽奖
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
剩余次数：2 次
已使用：1 次

📊 获得奖品
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 2025-12-25 14:30
   二等奖：100 USDT

[🎲 开始抽奖] [返回]

💡 每邀请 5 位好友完成首次交易，即可获得 1 次抽奖机会！
```

## 🔄 业务流程

### 用户注册流程
1. 用户 A 分享链接：`https://t.me/wushi68_bot?start=ref_WSP123`
2. 用户 B 点击链接，自动带上 `ref` 参数
3. Bot 检查 `ref` 参数，记录推荐关系（status: pending）
4. 用户 B 注册成功，推荐关系更新（status: registered）
5. 用户 B 完成首次交易，触发奖励发放

### 奖励发放流程
1. 用户 B 完成首次交易（paid）
2. 系统检查推荐关系，找到推荐人用户 A
3. 发放邀请奖励：用户 A 获得 10 USDT
4. 发放交易分红：用户 A 获得交易金额 1%（最高 100 USDT）
5. 发放好友红包：用户 B 获得 5 USDT
6. 更新推荐关系状态（status: rewarded）
7. 更新邀请计数（每 5 人触发抽奖机会）

### 抽奖流程
1. 用户邀请数达到 5 的倍数
2. 系统自动发放抽奖机会
3. 用户点击"开始抽奖"
4. 系统随机生成奖品等级
5. 发放对应奖励
6. 记录抽奖记录

### 排行榜流程
1. 每月 1 日重置排行榜
2. 实时统计本月邀请数量
3. 每月最后一天 23:59 锁定排名
4. 次月 5 日前发放奖励
5. 更新用户 VIP 等级（前 3 名）

## 🎯 运营策略

### 激励机制
1. **即时反馈**：好友注册/交易成功后立即通知
2. **进度可视化**：显示距离下次抽奖还需邀请几人
3. **排行榜激励**：实时显示排名，营造竞争氛围
4. **里程碑奖励**：邀请达到 10/50/100 人额外奖励

### 用户增长
1. **病毒式传播**：每个用户都有专属推荐码
2. **社交分享**：一键分享到 Telegram
3. **双重激励**：邀请者和被邀请者都有奖励
4. **持续收益**：交易分红提供长期激励

### 防作弊机制
1. **交易验证**：只有成功交易才计算奖励
2. **设备限制**：同一设备/IP 多次注册检测
3. **时间窗口**：新用户需在 7 天内完成首次交易
4. **人工审核**：异常数据人工审核

## 📊 数据追踪

### 关键指标
- 总邀请数
- 成功邀请数（完成首次交易）
- 转化率（注册→首次交易）
- 平均奖励金额
- 抽奖参与率
- 排行榜参与度

### 报表功能
- 每日/每周/每月邀请数据
- 奖励发放统计
- 用户活跃度分析
- ROI 分析

## 🚀 实施步骤

### 第一阶段：基础功能
1. 数据库表创建
2. 推荐码生成系统
3. 邀请链接处理
4. 基础奖励发放

### 第二阶段：核心功能
1. 抽奖系统
2. 排行榜功能
3. 奖励记录查询
4. UI 美化

### 第三阶段：优化功能
1. 防作弊机制
2. 数据统计报表
3. 消息推送优化
4. 用户体验优化

